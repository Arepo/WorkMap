<div class='header'>
	<h1>WorkMap</h1>
</div>

<div class='container'>

	<div id="search">
		<form id="search_box" method="post">
			<input type="text" address="test" id="searchTextField" placeholder="Address">
			<input type="submit" value="Search">
		</form>
	</div>

	<div id="map"></div>
	<script>
		$(document).ready(function(){

			var map = new GMaps({
				div: '#map',
				lat: 51.523126,
				lng: -0.087019
			});

			var defaultBounds = new google.maps.LatLngBounds(
				new google.maps.LatLng(51.2901, -0.5651),
				new google.maps.LatLng(51.6167, 0.2463));

			var input = document.getElementById('searchTextField');
			var options = {
				bounds: defaultBounds,
				types: ['establishment']
			};

			autocomplete = new google.maps.places.Autocomplete(input, options);

			$('#search_box').on('submit', function(event) {

				event.preventDefault();


				GMaps.geocode({
					address: $('#searchTextField').val(),
					callback: function(results, status) {
						if (status == 'OK') {
							var latlng = results[0].geometry.location;
							map.setCenter(latlng.lat(), latlng.lng());
						} 
					}
				});
			})

			<% @jobs.each do |job| %>
			GMaps.geocode({
				address: '<%= job.address %>',
				callback: function(results, status) {
					if (status == 'OK') {
						var latlng = results[0].geometry.location;
						var opt = { minZoom: 10, maxZoom: 17}
						map.setCenter(latlng.lat(), latlng.lng());
						map.addMarker({
							lat: latlng.lat(),
							lng: latlng.lng()
						});
						map.setOptions(opt);
					} 
				}
			});
			<% end %>
		})
</script>
</div>
<div class='footer'>
	<h4></h4>
</div>